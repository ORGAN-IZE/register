machine:
    environment:
        DJANGO_SETTINGS_MODULE: "settings.testing"
        KOMBU_FERNET_KEY: "L4l6A0cI0t_hN9aMWy3AUAqWv7XavOjeVGggyo7apKI="

test:
    override:
        - ./manage.py test_coverage

deployment:
    development:
        branch: master
        commands:
            - heroku maintenance:on --app fiftythree-client
            - git push git@heroku.com:fiftythree-client.git $CIRCLE_SHA1:refs/heads/master
            - heroku run ./manage.py migrate --noinput --app fiftythree-client
            - heroku maintenance:off --app fiftythree-client
    production:
        branch: production
        commands:
            - heroku maintenance:on --app fiftythree-client
            - git push git@heroku.com:fiftythree-client.git $CIRCLE_SHA1:refs/heads/production
            - heroku run ./manage.py migrate --noinput --app fiftythree-client
            - heroku maintenance:off --app fiftythree-client
