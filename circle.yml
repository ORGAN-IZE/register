machine:
    environment:
        DJANGO_SETTINGS_MODULE: "settings.testing"

deployment:
    security-testing:
        branch: security-testing
        commands:
            - git push git@heroku.com:security-testing.git $CIRCLE_SHA1:refs/heads/master -f :
                timeout: 400
            - heroku maintenance:on --app security-testing
            - heroku run ./manage.py migrate --noinput --app security-testing :
                timeout: 400
            - heroku maintenance:off --app security-testing
    development:
        branch: development
        commands:
            - git push git@heroku.com:register-dev.git $CIRCLE_SHA1:refs/heads/master -f :
                timeout: 400
            - heroku maintenance:on --app register-dev
            - heroku run ./manage.py migrate --noinput --app register-dev :
                timeout: 400
            - heroku maintenance:off --app register-dev
    production:
        branch: production
        commands:
            - git push git@heroku.com:register-prod.git $CIRCLE_SHA1:refs/heads/master -f :
                timeout: 400
            - heroku maintenance:on --app register-prod
            - heroku run ./manage.py migrate --noinput --app register-prod :
                timeout: 400
            - heroku maintenance:off --app register-prod
